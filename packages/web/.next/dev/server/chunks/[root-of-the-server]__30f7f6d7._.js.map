{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nisch/Desktop/Velocity-1/packages/web/app/api/validate/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport * as snarkjs from \"snarkjs\";\nimport { readFile } from \"fs/promises\";\nimport path from \"path\";\n\nexport const runtime = \"nodejs\";\n\nlet vkeyCache: object | null = null;\n\nasync function getVkey() {\n  if (vkeyCache) return vkeyCache;\n  const vkeyPath = path.join(process.cwd(), \"public\", \"zk\", \"verification_key.json\");\n  const raw = await readFile(vkeyPath, \"utf-8\");\n  vkeyCache = JSON.parse(raw);\n  return vkeyCache;\n}\n\nexport async function POST(req: Request) {\n  try {\n    const { proof, publicSignals } = await req.json();\n    if (!proof || !Array.isArray(publicSignals)) {\n      return NextResponse.json(\n        { verified: false, error: \"Missing proof or publicSignals\" },\n        { status: 400 }\n      );\n    }\n\n    const vkey = await getVkey();\n    const isValid = await snarkjs.groth16.verify(vkey, publicSignals, proof);\n    const verified = isValid && publicSignals[0] === \"1\";\n\n    return NextResponse.json({ verified });\n  } catch (err: unknown) {\n    const msg = err instanceof Error ? err.message : String(err);\n    return NextResponse.json({ verified: false, error: msg }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAEvB,IAAI,YAA2B;AAE/B,eAAe;IACb,IAAI,WAAW,OAAO;IACtB,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,UAAU,MAAM;IAC1D,MAAM,MAAM,MAAM,IAAA,iIAAQ,EAAC,UAAU;IACrC,YAAY,KAAK,KAAK,CAAC;IACvB,OAAO;AACT;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG,MAAM,IAAI,IAAI;QAC/C,IAAI,CAAC,SAAS,CAAC,MAAM,OAAO,CAAC,gBAAgB;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,UAAU;gBAAO,OAAO;YAAiC,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM;QACnB,MAAM,UAAU,MAAM,yLAAe,CAAC,MAAM,CAAC,MAAM,eAAe;QAClE,MAAM,WAAW,WAAW,aAAa,CAAC,EAAE,KAAK;QAEjD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAS;IACtC,EAAE,OAAO,KAAc;QACrB,MAAM,MAAM,eAAe,QAAQ,IAAI,OAAO,GAAG,OAAO;QACxD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,UAAU;YAAO,OAAO;QAAI,GAAG;YAAE,QAAQ;QAAI;IAC1E;AACF"}}]
}